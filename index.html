<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>N5 å±±æ‰‹ç·šã‚²ãƒ¼ãƒ </title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body {
            font-family: 'M PLUS Rounded 1c', sans-serif;
            background-color: #f0fdf4;
            background-image: radial-gradient(#dcfce7 2px, transparent 2px);
            background-size: 20px 20px;
        }
        .train-animation {
            animation: moveTrain 10s linear infinite;
        }
        @keyframes moveTrain {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100vw); }
        }
        .card-shadow {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        .timer-bar {
            transition: width 0.1s linear;
        }
        /* Ruby styling adjustment if needed, though parentheses used for compatibility */
    </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center p-4 text-slate-700">

    <!-- Header / Decoration -->
    <div class="w-full fixed top-0 left-0 overflow-hidden pointer-events-none opacity-30 h-16">
        <div class="train-animation text-4xl absolute top-4">ğŸšƒ</div>
    </div>

    <!-- Main Container -->
    <main class="w-full max-w-4xl bg-white rounded-3xl p-6 md:p-8 card-shadow border-4 border-green-200 relative z-10">
        
        <!-- Game Title -->
        <header class="text-center mb-6">
            <h1 class="text-3xl md:text-4xl font-bold text-green-600 mb-2">å±±æ‰‹ç·šã‚²ãƒ¼ãƒ </h1>
            <p class="text-slate-500">N5 èªå½™ç·´ç¿’</p>
        </header>

        <!-- STATE: MENU (Category Selection) -->
        <div id="menu-screen" class="block">
            <p class="text-center mb-4 text-lg font-bold">ã‚«ãƒ†ã‚´ãƒªãƒ¼ã‚’é¸ã‚“ã§ãã ã•ã„</p>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                <!-- Categories generated by JS -->
            </div>
            
            <div class="mt-8 p-4 bg-yellow-50 rounded-xl border border-yellow-200 text-sm">
                <h3 class="font-bold text-yellow-700 mb-2 flex items-center gap-2">
                    <i data-lucide="info" class="w-4 h-4"></i> ãƒ«ãƒ¼ãƒ«
                </h3>
                <ul class="list-disc list-inside text-yellow-800 space-y-1">
                    <li>é †ç•ªã«å˜èªã‚’è¨€ã„ã¾ã™</li>
                    <li>ã€Œã€œã§ã™ï¼ã€œã¾ã™ã€ã‚’ã¤ã‘ã¦è¨€ã„ã¾ã—ã‚‡ã†</li>
                    <li>ã‚ã‹ã‚‰ãªã‹ã£ãŸã‚‰ã€Œãƒ‘ã‚¹ã€ã¨è¨€ã£ã¦ãã ã•ã„</li>
                </ul>
            </div>
        </div>

        <!-- STATE: GAMEPLAY -->
        <div id="game-screen" class="hidden">
            <!-- Current Category Display -->
            <div class="text-center mb-6 bg-green-50 p-4 rounded-xl border border-green-100">
                <span class="text-sm text-green-600 font-bold block mb-1">ãƒ†ãƒ¼ãƒ</span>
                <h2 id="current-category-name" class="text-3xl font-bold text-green-700"></h2>
            </div>

            <!-- Turn Indicator -->
            <div class="flex justify-between items-center mb-4 px-4 md:px-12">
                <div id="player-indicator" class="flex flex-col items-center transition-all duration-300 transform scale-100">
                    <span class="text-3xl mb-1">ğŸ§‘â€ğŸ“</span>
                    <span class="font-bold text-base bg-blue-100 px-4 py-1 rounded-full text-blue-700">å­¦ç”Ÿ</span>
                </div>
                <div class="text-2xl font-bold text-slate-300">VS</div>
                <div id="teacher-indicator" class="flex flex-col items-center transition-all duration-300 opacity-50 transform scale-90">
                    <span class="text-3xl mb-1">ğŸ‘©â€ğŸ«</span>
                    <span class="font-bold text-base bg-orange-100 px-4 py-1 rounded-full text-orange-700">å…ˆç”Ÿ</span>
                </div>
            </div>

            <!-- Timer Visual -->
            <div class="w-full h-8 bg-slate-200 rounded-full overflow-hidden mb-8 relative">
                <div id="timer-bar" class="h-full bg-green-500 rounded-full timer-bar w-full"></div>
                <div class="absolute inset-0 flex items-center justify-center text-xs font-bold text-white drop-shadow-md">
                    <span id="timer-text">æ®‹ã‚Šæ™‚é–“</span>
                </div>
            </div>

            <!-- Controls -->
            <div class="grid grid-cols-2 gap-4 mb-6">
                <button onclick="nextTurn()" class="col-span-1 bg-blue-500 hover:bg-blue-600 text-white py-4 rounded-xl font-bold text-lg shadow-md active:translate-y-1 transition-all flex items-center justify-center gap-2">
                    <i data-lucide="check-circle"></i> OK / æ¬¡ã¸
                </button>
                <button onclick="toggleHints()" class="col-span-1 bg-yellow-400 hover:bg-yellow-500 text-white py-4 rounded-xl font-bold text-lg shadow-md active:translate-y-1 transition-all flex items-center justify-center gap-2">
                    <i data-lucide="lightbulb"></i> ãƒ’ãƒ³ãƒˆ
                </button>
            </div>

            <button onclick="endGame()" class="w-full bg-slate-200 hover:bg-slate-300 text-slate-600 py-2 rounded-lg font-bold text-sm">
                çµ‚äº†ã™ã‚‹
            </button>

            <!-- Hint Modal / Area -->
            <div id="hint-area" class="hidden mt-6 p-4 bg-white border-2 border-dashed border-slate-200 rounded-xl">
                <h3 class="text-center font-bold text-slate-500 mb-3 text-sm">å˜èªãƒªã‚¹ãƒˆ</h3>
                <div id="hint-list" class="flex flex-wrap justify-center gap-2">
                    <!-- Hints injected here -->
                </div>
            </div>
        </div>

        <!-- STATE: GAME OVER -->
        <div id="result-screen" class="hidden text-center">
            <div class="text-6xl mb-4">ğŸ‰</div>
            <h2 class="text-2xl font-bold mb-2">ãŠç–²ã‚Œæ§˜ã§ã—ãŸï¼</h2>
            <p class="text-slate-500 mb-8">ã‚ˆãé ‘å¼µã‚Šã¾ã—ãŸ</p>
            
            <button onclick="resetGame()" class="bg-green-500 hover:bg-green-600 text-white px-8 py-3 rounded-xl font-bold text-lg shadow-md">
                ã‚‚ã†ä¸€åº¦
            </button>
        </div>

    </main>

    <script>
        // Initialize Icons
        lucide.createIcons();

        // Game Data (Expanded to 12 Categories, ~20 words each, Kanji representation)
        const categories = [
            {
                id: 'animals',
                name: 'å‹•ç‰©',
                icon: 'ğŸ¶',
                color: 'bg-orange-100 text-orange-700',
                words: ['çŠ¬', 'çŒ«', 'é³¥', 'é­š', 'ç‰›', 'é¦¬', 'è±¡', 'ãƒ‘ãƒ³ãƒ€', 'å…', 'çŒ¿', 'ãƒ©ã‚¤ã‚ªãƒ³', 'è™', 'ç†Š', 'ç¾Š', 'è±š', 'ãƒã‚ºãƒŸ', 'ã‚¤ãƒ«ã‚«', 'ãƒšãƒ³ã‚®ãƒ³', 'ã‚­ãƒªãƒ³', 'è›‡']
            },
            {
                id: 'food',
                name: 'é£Ÿã¹ç‰©',
                icon: 'ğŸ™',
                color: 'bg-red-100 text-red-700',
                words: ['ã”é£¯', 'ãƒ‘ãƒ³', 'è‚‰', 'é­š', 'åµ', 'é‡èœ', 'æœç‰©', 'æ°´', 'ãŠèŒ¶', 'ç‰›ä¹³', 'ã‚Šã‚“ã”', 'ã¿ã‹ã‚“', 'ãƒãƒŠãƒŠ', 'ã‚«ãƒ¬ãƒ¼', 'ãƒ©ãƒ¼ãƒ¡ãƒ³', 'å¯¿å¸', 'å¤©ã·ã‚‰', 'ã‚±ãƒ¼ã‚­', 'ã‚³ãƒ¼ãƒ’ãƒ¼', 'ãƒ“ãƒ¼ãƒ«']
            },
            {
                id: 'colors',
                name: 'è‰²',
                icon: 'ğŸ¨',
                color: 'bg-blue-100 text-blue-700',
                words: ['èµ¤', 'é’', 'é»„è‰²', 'ç·‘', 'é»’', 'ç™½', 'èŒ¶è‰²', 'ãƒ”ãƒ³ã‚¯', 'ã‚ªãƒ¬ãƒ³ã‚¸', 'ç´«', 'é‡‘è‰²', 'éŠ€è‰²', 'ç°è‰²', 'æ°´è‰²', 'ç´ºè‰²', 'ãƒ™ãƒ¼ã‚¸ãƒ¥', 'ã‚¯ãƒªãƒ¼ãƒ è‰²', 'è™¹è‰²', 'æ˜ã‚‹ã„è‰²', 'æš—ã„è‰²']
            },
            {
                id: 'calendar',
                name: 'æ™‚é–“ãƒ»ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼',
                icon: 'ğŸ“…',
                color: 'bg-purple-100 text-purple-700',
                words: ['æœˆæ›œæ—¥', 'ç«æ›œæ—¥', 'æ°´æ›œæ—¥', 'æœ¨æ›œæ—¥', 'é‡‘æ›œæ—¥', 'åœŸæ›œæ—¥', 'æ—¥æ›œæ—¥', '1æœˆ', '8æœˆ', '12æœˆ', 'ä»Šæ—¥', 'æ˜æ—¥', 'æ˜¨æ—¥', 'é€±æœ«', 'æ¥é€±', 'ä»Šæœˆ', 'å»å¹´', 'æœ', 'æ˜¼', 'å¤œ']
            },
            {
                id: 'family',
                name: 'å®¶æ—ãƒ»äºº',
                icon: 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§',
                color: 'bg-pink-100 text-pink-700',
                words: ['çˆ¶', 'æ¯', 'å…„', 'å§‰', 'å¼Ÿ', 'å¦¹', 'ç¥–çˆ¶', 'ç¥–æ¯', 'å®¶æ—', 'å…„å¼Ÿ', 'ãŠçˆ¶ã•ã‚“', 'ãŠæ¯ã•ã‚“', 'å­ä¾›', 'ç”·ã®äºº', 'å¥³ã®äºº', 'ç”·ã®å­', 'å¥³ã®å­', 'å‹é”', 'å½¼', 'å½¼å¥³']
            },
            {
                id: 'town',
                name: 'ç”ºãƒ»å ´æ‰€',
                icon: 'ğŸª',
                color: 'bg-teal-100 text-teal-700',
                words: ['é§…', 'å­¦æ ¡', 'ç—…é™¢', 'ãƒ‡ãƒ‘ãƒ¼ãƒˆ', 'ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³', 'ã‚¹ãƒ¼ãƒ‘ãƒ¼', 'ãƒˆã‚¤ãƒ¬', 'å…¬åœ’', 'ãƒ›ãƒ†ãƒ«', 'éŠ€è¡Œ', 'éƒµä¾¿å±€', 'äº¤ç•ª', 'å›³æ›¸é¤¨', 'ç¾è¡“é¤¨', 'ã‚³ãƒ³ãƒ“ãƒ‹', 'æœ¬å±‹', 'èŠ±å±‹', 'è–¬å±€', 'ç©ºæ¸¯', 'å¤§ä½¿é¤¨']
            },
            {
                id: 'body',
                name: 'ä½“',
                icon: 'ğŸ’ª',
                color: 'bg-amber-100 text-amber-700',
                words: ['é ­', 'ç›®', 'è€³', 'å£', 'é¼»', 'æ‰‹', 'è¶³', 'é¡”', 'é«ª', 'ãŠè…¹', 'èƒŒä¸­', 'æŒ‡', 'æ­¯', 'é¦–', 'å–‰', 'èƒ¸', 'è…•', 'çˆª', 'è†', 'è‚©']
            },
            {
                id: 'house',
                name: 'å®¶ãƒ»éƒ¨å±‹',
                icon: 'ğŸ ',
                color: 'bg-indigo-100 text-indigo-700',
                words: ['å®¶', 'éƒ¨å±‹', 'çª“', 'ãƒ‰ã‚¢', 'æœº', 'æ¤…å­', 'ãƒ†ãƒ¬ãƒ“', 'å†·è”µåº«', 'æ™‚è¨ˆ', 'ãƒ™ãƒƒãƒ‰', 'å°æ‰€', 'ãŠé¢¨å‘‚', 'ãƒˆã‚¤ãƒ¬', 'ç„é–¢', 'åº­', 'éšæ®µ', 'ã‚½ãƒ•ã‚¡', 'ã‚¨ã‚¢ã‚³ãƒ³', 'æœ¬æ£š', 'éµ']
            },
            {
                id: 'clothes',
                name: 'æœãƒ»èº«ã«ã¤ã‘ã‚‹ç‰©',
                icon: 'ğŸ‘•',
                color: 'bg-rose-100 text-rose-700',
                words: ['ã‚·ãƒ£ãƒ„', 'ã‚ºãƒœãƒ³', 'é´', 'é´ä¸‹', 'å¸½å­', 'çœ¼é¡', 'ã‚³ãƒ¼ãƒˆ', 'ã‚¹ã‚«ãƒ¼ãƒˆ', 'ãƒã‚¯ã‚¿ã‚¤', 'ã‚¹ãƒ¼ãƒ„', 'Tã‚·ãƒ£ãƒ„', 'ã‚¸ãƒ¼ãƒ³ã‚º', 'ã‚»ãƒ¼ã‚¿ãƒ¼', 'ã‚¸ãƒ£ã‚±ãƒƒãƒˆ', 'ç€ç‰©', 'ä¸‹ç€', 'ãƒãƒ•ãƒ©ãƒ¼', 'æ‰‹è¢‹', 'æ°´ç€', 'ãƒ™ãƒ«ãƒˆ']
            },
            {
                id: 'nature',
                name: 'è‡ªç„¶ãƒ»å¤©æ°—',
                icon: 'ğŸŒ³',
                color: 'bg-emerald-100 text-emerald-700',
                words: ['å±±', 'å·', 'æµ·', 'ç©º', 'é›¨', 'é›ª', 'æ™´ã‚Œ', 'æ›‡ã‚Š', 'é¢¨', 'èŠ±', 'æœ¨', 'æ£®', 'æ—', 'æ± ', 'æ˜Ÿ', 'æœˆ', 'å¤ªé™½', 'é›·', 'å°é¢¨', 'åœ°éœ‡']
            },
            {
                id: 'vehicles',
                name: 'ä¹—ã‚Šç‰©',
                icon: 'ğŸš—',
                color: 'bg-cyan-100 text-cyan-700',
                words: ['é›»è»Š', 'ãƒã‚¹', 'è»Š', 'ã‚¿ã‚¯ã‚·ãƒ¼', 'è‡ªè»¢è»Š', 'åœ°ä¸‹é‰„', 'é£›è¡Œæ©Ÿ', 'èˆ¹', 'æ–°å¹¹ç·š', 'ã‚ªãƒ¼ãƒˆãƒã‚¤', 'ãƒˆãƒ©ãƒƒã‚¯', 'ãƒ‘ãƒˆã‚«ãƒ¼', 'æ•‘æ€¥è»Š', 'ãƒ˜ãƒªã‚³ãƒ—ã‚¿ãƒ¼', 'ãƒ­ã‚±ãƒƒãƒˆ', 'é§…', 'ç©ºæ¸¯', 'æ¸¯', 'ä¿¡å·', 'é“']
            },
            {
                id: 'stationery',
                name: 'æ–‡æˆ¿å…·ãƒ»å­¦æ ¡',
                icon: 'âœï¸',
                color: 'bg-yellow-100 text-yellow-700',
                words: ['é‰›ç­†', 'ãƒšãƒ³', 'ãƒãƒ¼ãƒˆ', 'æœ¬', 'è¾æ›¸', 'æ¶ˆã—ã‚´ãƒ ', 'ç®±', 'æ‰‹ç´™', 'åˆ‡æ‰‹', 'å°ç­’', 'ãƒã‚µãƒŸ', 'ãƒ›ãƒƒãƒã‚­ã‚¹', 'å®šè¦', 'ãƒœãƒ¼ãƒ«ãƒšãƒ³', 'ã‚«ãƒãƒ³', 'æ•™ç§‘æ›¸', 'é›‘èªŒ', 'æ–°è', 'åœ°å›³', 'å†™çœŸ']
            }
        ];

        // State
        let currentCategory = null;
        let isPlayerTurn = true; // true = student, false = teacher
        let timerInterval = null;
        let timeLeft = 0;
        const TIME_LIMIT = 15;

        // DOM Elements
        const menuScreen = document.getElementById('menu-screen');
        const gameScreen = document.getElementById('game-screen');
        const resultScreen = document.getElementById('result-screen');
        const categoryContainer = document.querySelector('#menu-screen .grid');
        
        // Init Menu
        function initMenu() {
            categoryContainer.innerHTML = '';
            categories.forEach(cat => {
                const btn = document.createElement('button');
                btn.className = `${cat.color} p-4 rounded-xl shadow-sm hover:shadow-md transition-all font-bold text-left flex flex-col gap-2 h-24 justify-center items-center border border-white/50`;
                btn.innerHTML = `<span class="text-2xl">${cat.icon}</span><span class="text-sm md:text-base whitespace-nowrap">${cat.name}</span>`;
                btn.onclick = () => startGame(cat);
                categoryContainer.appendChild(btn);
            });
        }

        // Start Game
        function startGame(category) {
            currentCategory = category;
            menuScreen.classList.add('hidden');
            gameScreen.classList.remove('hidden');
            resultScreen.classList.add('hidden');

            document.getElementById('current-category-name').textContent = category.name;
            
            // Setup Hints
            const hintList = document.getElementById('hint-list');
            hintList.innerHTML = '';
            category.words.forEach(word => {
                const span = document.createElement('span');
                span.className = 'px-3 py-1 bg-slate-100 hover:bg-slate-200 rounded text-slate-700 text-base border border-slate-200';
                span.textContent = word;
                hintList.appendChild(span);
            });
            document.getElementById('hint-area').classList.add('hidden');

            // Start First Turn
            isPlayerTurn = true;
            updateTurnUI();
            resetTimer();
        }

        // Toggle Turn
        function nextTurn() {
            clearInterval(timerInterval);
            isPlayerTurn = !isPlayerTurn;
            updateTurnUI();
            resetTimer();
        }

        function updateTurnUI() {
            const pInd = document.getElementById('player-indicator');
            const tInd = document.getElementById('teacher-indicator');

            if (isPlayerTurn) {
                pInd.classList.remove('opacity-50', 'scale-90');
                pInd.classList.add('scale-100');
                tInd.classList.add('opacity-50', 'scale-90');
                tInd.classList.remove('scale-100');
            } else {
                tInd.classList.remove('opacity-50', 'scale-90');
                tInd.classList.add('scale-100');
                pInd.classList.add('opacity-50', 'scale-90');
                pInd.classList.remove('scale-100');
            }
        }

        // Timer Logic
        function resetTimer() {
            timeLeft = TIME_LIMIT;
            updateTimerVisual();
            
            if (timerInterval) clearInterval(timerInterval);
            
            timerInterval = setInterval(() => {
                timeLeft -= 0.1;
                if (timeLeft <= 0) {
                    timeLeft = 0;
                    clearInterval(timerInterval);
                }
                updateTimerVisual();
            }, 100);
        }

        function updateTimerVisual() {
            const percentage = (timeLeft / TIME_LIMIT) * 100;
            const bar = document.getElementById('timer-bar');
            bar.style.width = `${percentage}%`;
            
            // Color change based on time
            if (percentage < 30) {
                bar.classList.remove('bg-green-500', 'bg-yellow-400');
                bar.classList.add('bg-red-500');
            } else if (percentage < 60) {
                bar.classList.remove('bg-green-500', 'bg-red-500');
                bar.classList.add('bg-yellow-400');
            } else {
                bar.classList.remove('bg-yellow-400', 'bg-red-500');
                bar.classList.add('bg-green-500');
            }
        }

        // Hint Toggle
        function toggleHints() {
            const area = document.getElementById('hint-area');
            area.classList.toggle('hidden');
        }

        // End Game Flow
        function endGame() {
            clearInterval(timerInterval);
            gameScreen.classList.add('hidden');
            resultScreen.classList.remove('hidden');
        }

        function resetGame() {
            resultScreen.classList.add('hidden');
            menuScreen.classList.remove('hidden');
        }

        // Init
        initMenu();

    </script>
</body>
</html>